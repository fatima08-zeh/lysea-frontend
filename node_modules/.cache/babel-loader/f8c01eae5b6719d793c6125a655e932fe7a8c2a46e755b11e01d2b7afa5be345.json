{"ast":null,"code":"// src/pages/AccountPage.jsx\nimport React,{useContext,useEffect,useState}from\"react\";import axios from\"axios\";import{UserContext}from\"../context/UserContext\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const AccountPage=()=>{const{user,token,logout}=useContext(UserContext);const navigate=useNavigate();const[data,setData]=useState({nom:\"\",email:\"\",adresse:\"\",telephone:\"\"});const[editing,setEditing]=useState(false);const[loading,setLoading]=useState(true);// Récupère les infos au chargement\nuseEffect(()=>{if(!user){navigate(\"/login\");return;}axios.get(`http://localhost:5001/api/users/${user.id}`,{headers:{Authorization:`Bearer ${token}`}}).then(res=>{setData({nom:res.data.nom,email:res.data.email,adresse:res.data.adresse||\"\",telephone:res.data.telephone||\"\"});}).catch(err=>{var _err$response;console.error(err);if(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===401)logout();}).finally(()=>setLoading(false));},[user,token,logout,navigate]);const handleChange=e=>{setData(prev=>({...prev,[e.target.name]:e.target.value}));};const handleSave=()=>{axios.put(`http://localhost:5001/api/users/${user.id}`,{adresse:data.adresse,telephone:data.telephone},{headers:{Authorization:`Bearer ${token}`}}).then(()=>{setEditing(false);}).catch(err=>console.error(err));};if(loading)return/*#__PURE__*/_jsx(\"p\",{children:\"Chargement\\u2026\"});return/*#__PURE__*/_jsxs(\"div\",{style:{padding:40,maxWidth:600,margin:\"0 auto\"},children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Mon compte\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Nom :\"}),\" \",data.nom]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email :\"}),\" \",data.email]}),!editing?/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditing(true),children:\"Modifier mes infos\"}):/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:20},children:[/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:12},children:/*#__PURE__*/_jsxs(\"label\",{children:[\"Adresse :\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"adresse\",value:data.adresse,onChange:handleChange,style:{width:\"100%\",padding:8,marginTop:4}})]})}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:12},children:/*#__PURE__*/_jsxs(\"label\",{children:[\"T\\xE9l\\xE9phone :\",/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"telephone\",value:data.telephone,onChange:handleChange,style:{width:\"100%\",padding:8,marginTop:4}})]})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,style:{marginRight:12},children:\"Enregistrer\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setEditing(false),children:\"Annuler\"})]})]});};export default AccountPage;","map":{"version":3,"names":["React","useContext","useEffect","useState","axios","UserContext","useNavigate","jsx","_jsx","jsxs","_jsxs","AccountPage","user","token","logout","navigate","data","setData","nom","email","adresse","telephone","editing","setEditing","loading","setLoading","get","id","headers","Authorization","then","res","catch","err","_err$response","console","error","response","status","finally","handleChange","e","prev","target","name","value","handleSave","put","children","style","padding","maxWidth","margin","onClick","marginTop","marginBottom","type","onChange","width","marginRight"],"sources":["C:/Users/Admin/Desktop/stage25/frontend/src/pages/AccountPage.js"],"sourcesContent":["// src/pages/AccountPage.jsx\r\nimport React, { useContext, useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { UserContext } from \"../context/UserContext\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nconst AccountPage = () => {\r\n  const { user, token, logout } = useContext(UserContext);\r\n  const navigate = useNavigate();\r\n\r\n  const [data, setData] = useState({\r\n    nom: \"\",\r\n    email: \"\",\r\n    adresse: \"\",\r\n    telephone: \"\"\r\n  });\r\n  const [editing, setEditing] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  // Récupère les infos au chargement\r\n  useEffect(() => {\r\n  if (!user) {\r\n    navigate(\"/login\");\r\n    return;\r\n  }\r\n  axios\r\n    .get(`http://localhost:5001/api/users/${user.id}`, {\r\n      headers: { Authorization: `Bearer ${token}` }\r\n    })\r\n    .then(res => {\r\n      setData({\r\n        nom:       res.data.nom,\r\n        email:     res.data.email,\r\n        adresse:   res.data.adresse   || \"\",\r\n        telephone: res.data.telephone || \"\"\r\n      });\r\n    })\r\n    .catch(err => {\r\n      console.error(err);\r\n      if (err.response?.status === 401) logout();\r\n    })\r\n    .finally(() => setLoading(false));\r\n}, [user, token, logout, navigate]);\r\n\r\n\r\n  const handleChange = e => {\r\n    setData(prev => ({ ...prev, [e.target.name]: e.target.value }));\r\n  };\r\n\r\n  const handleSave = () => {\r\n    axios\r\n      .put(\r\n        `http://localhost:5001/api/users/${user.id}`,\r\n        { adresse: data.adresse, telephone: data.telephone },\r\n        { headers: { Authorization: `Bearer ${token}` } }\r\n      )\r\n      .then(() => {\r\n        setEditing(false);\r\n      })\r\n      .catch(err => console.error(err));\r\n  };\r\n\r\n  if (loading) return <p>Chargement…</p>;\r\n\r\n  return (\r\n    <div style={{ padding: 40, maxWidth: 600, margin: \"0 auto\" }}>\r\n      <h1>Mon compte</h1>\r\n\r\n      <p>\r\n        <strong>Nom :</strong> {data.nom}\r\n      </p>\r\n      <p>\r\n        <strong>Email :</strong> {data.email}\r\n      </p>\r\n\r\n      {/* Bouton bascule édition */}\r\n      {!editing ? (\r\n        <button onClick={() => setEditing(true)}>Modifier mes infos</button>\r\n      ) : (\r\n        <div style={{ marginTop: 20 }}>\r\n          <div style={{ marginBottom: 12 }}>\r\n            <label>\r\n              Adresse :\r\n              <input\r\n                type=\"text\"\r\n                name=\"adresse\"\r\n                value={data.adresse}\r\n                onChange={handleChange}\r\n                style={{ width: \"100%\", padding: 8, marginTop: 4 }}\r\n              />\r\n            </label>\r\n          </div>\r\n          <div style={{ marginBottom: 12 }}>\r\n            <label>\r\n              Téléphone :\r\n              <input\r\n                type=\"text\"\r\n                name=\"telephone\"\r\n                value={data.telephone}\r\n                onChange={handleChange}\r\n                style={{ width: \"100%\", padding: 8, marginTop: 4 }}\r\n              />\r\n            </label>\r\n          </div>\r\n          <button onClick={handleSave} style={{ marginRight: 12 }}>\r\n            Enregistrer\r\n          </button>\r\n          <button onClick={() => setEditing(false)}>Annuler</button>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AccountPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}