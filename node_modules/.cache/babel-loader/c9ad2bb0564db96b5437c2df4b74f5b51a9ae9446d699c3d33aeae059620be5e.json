{"ast":null,"code":"import React,{createContext,useState,useContext,useEffect}from\"react\";import axios from\"axios\";import{UserContext}from\"./UserContext\";import{jsx as _jsx}from\"react/jsx-runtime\";export const FavoritesContext=/*#__PURE__*/createContext();// ✅ Export correct du contexte\nexport const FavoritesProvider=_ref=>{let{children}=_ref;const{user}=useContext(UserContext)||{};const[favorites,setFavorites]=useState([]);// Charger les favoris depuis la base de données\nuseEffect(()=>{if(user&&user.id){axios.get(`http://localhost:5001/api/favorites/${user.id}`).then(response=>{setFavorites(response.data);}).catch(error=>console.error(\"❌ Erreur chargement des favoris :\",error));}},[user]);// ✅ Ajouter un produit aux favoris ou le retirer\nconst toggleFavorite=async product=>{const isFavorite=favorites.some(fav=>fav.id===product.id);try{if(isFavorite){await axios.delete(\"http://localhost:5001/api/favorites/remove\",{data:{user_id:user.id,product_id:product.id}});setFavorites(favorites.filter(fav=>fav.id!==product.id));}else{await axios.post(\"http://localhost:5001/api/favorites/add\",{user_id:user.id,product_id:product.id});setFavorites([...favorites,product]);}}catch(error){console.error(\"❌ Erreur gestion des favoris :\",error);}};// ✅ Fonction pour vider tous les favoris\nconst clearFavorites=()=>{setFavorites([]);localStorage.removeItem(\"favorites\");};return/*#__PURE__*/_jsx(FavoritesContext.Provider,{value:{favorites,toggleFavorite,setFavorites,clearFavorites},children:children});};","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","axios","UserContext","jsx","_jsx","FavoritesContext","FavoritesProvider","_ref","children","user","favorites","setFavorites","id","get","then","response","data","catch","error","console","toggleFavorite","product","isFavorite","some","fav","delete","user_id","product_id","filter","post","clearFavorites","localStorage","removeItem","Provider","value"],"sources":["C:/Users/Admin/Desktop/stage25/frontend/src/context/FavoritesContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { UserContext } from \"./UserContext\";\r\n\r\nexport const FavoritesContext = createContext(); // ✅ Export correct du contexte\r\n\r\nexport const FavoritesProvider = ({ children }) => {\r\n    const { user } = useContext(UserContext) || {};\r\n    const [favorites, setFavorites] = useState([]);\r\n\r\n    // Charger les favoris depuis la base de données\r\n    useEffect(() => {\r\n        if (user && user.id) {\r\n            axios\r\n                .get(`http://localhost:5001/api/favorites/${user.id}`)\r\n                .then((response) => {\r\n                    setFavorites(response.data);\r\n                })\r\n                .catch((error) => console.error(\"❌ Erreur chargement des favoris :\", error));\r\n        }\r\n    }, [user]);\r\n\r\n    // ✅ Ajouter un produit aux favoris ou le retirer\r\n    const toggleFavorite = async (product) => {\r\n        const isFavorite = favorites.some((fav) => fav.id === product.id);\r\n    \r\n        try {\r\n            if (isFavorite) {\r\n                await axios.delete(\"http://localhost:5001/api/favorites/remove\", {\r\n                    data: { user_id: user.id, product_id: product.id },\r\n                });\r\n                setFavorites(favorites.filter((fav) => fav.id !== product.id));\r\n            } else {\r\n                await axios.post(\"http://localhost:5001/api/favorites/add\", {\r\n                    user_id: user.id,\r\n                    product_id: product.id,\r\n                });\r\n                setFavorites([...favorites, product]);\r\n            }\r\n        } catch (error) {\r\n            console.error(\"❌ Erreur gestion des favoris :\", error);\r\n        }\r\n    };\r\n\r\n    // ✅ Fonction pour vider tous les favoris\r\n    const clearFavorites = () => {\r\n        setFavorites([]);\r\n        localStorage.removeItem(\"favorites\");\r\n    };\r\n    \r\n    return (\r\n        <FavoritesContext.Provider value={{ favorites, toggleFavorite, setFavorites, clearFavorites }}>\r\n            {children}\r\n        </FavoritesContext.Provider>\r\n    );\r\n};\r\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,QAAQ,CAAEC,UAAU,CAAEC,SAAS,KAAQ,OAAO,CAC7E,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,WAAW,KAAQ,eAAe,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE5C,MAAO,MAAM,CAAAC,gBAAgB,cAAGR,aAAa,CAAC,CAAC,CAAE;AAEjD,MAAO,MAAM,CAAAS,iBAAiB,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAC1C,KAAM,CAAEE,IAAK,CAAC,CAAGV,UAAU,CAACG,WAAW,CAAC,EAAI,CAAC,CAAC,CAC9C,KAAM,CAACQ,SAAS,CAAEC,YAAY,CAAC,CAAGb,QAAQ,CAAC,EAAE,CAAC,CAE9C;AACAE,SAAS,CAAC,IAAM,CACZ,GAAIS,IAAI,EAAIA,IAAI,CAACG,EAAE,CAAE,CACjBX,KAAK,CACAY,GAAG,CAAC,uCAAuCJ,IAAI,CAACG,EAAE,EAAE,CAAC,CACrDE,IAAI,CAAEC,QAAQ,EAAK,CAChBJ,YAAY,CAACI,QAAQ,CAACC,IAAI,CAAC,CAC/B,CAAC,CAAC,CACDC,KAAK,CAAEC,KAAK,EAAKC,OAAO,CAACD,KAAK,CAAC,mCAAmC,CAAEA,KAAK,CAAC,CAAC,CACpF,CACJ,CAAC,CAAE,CAACT,IAAI,CAAC,CAAC,CAEV;AACA,KAAM,CAAAW,cAAc,CAAG,KAAO,CAAAC,OAAO,EAAK,CACtC,KAAM,CAAAC,UAAU,CAAGZ,SAAS,CAACa,IAAI,CAAEC,GAAG,EAAKA,GAAG,CAACZ,EAAE,GAAKS,OAAO,CAACT,EAAE,CAAC,CAEjE,GAAI,CACA,GAAIU,UAAU,CAAE,CACZ,KAAM,CAAArB,KAAK,CAACwB,MAAM,CAAC,4CAA4C,CAAE,CAC7DT,IAAI,CAAE,CAAEU,OAAO,CAAEjB,IAAI,CAACG,EAAE,CAAEe,UAAU,CAAEN,OAAO,CAACT,EAAG,CACrD,CAAC,CAAC,CACFD,YAAY,CAACD,SAAS,CAACkB,MAAM,CAAEJ,GAAG,EAAKA,GAAG,CAACZ,EAAE,GAAKS,OAAO,CAACT,EAAE,CAAC,CAAC,CAClE,CAAC,IAAM,CACH,KAAM,CAAAX,KAAK,CAAC4B,IAAI,CAAC,yCAAyC,CAAE,CACxDH,OAAO,CAAEjB,IAAI,CAACG,EAAE,CAChBe,UAAU,CAAEN,OAAO,CAACT,EACxB,CAAC,CAAC,CACFD,YAAY,CAAC,CAAC,GAAGD,SAAS,CAAEW,OAAO,CAAC,CAAC,CACzC,CACJ,CAAE,MAAOH,KAAK,CAAE,CACZC,OAAO,CAACD,KAAK,CAAC,gCAAgC,CAAEA,KAAK,CAAC,CAC1D,CACJ,CAAC,CAED;AACA,KAAM,CAAAY,cAAc,CAAGA,CAAA,GAAM,CACzBnB,YAAY,CAAC,EAAE,CAAC,CAChBoB,YAAY,CAACC,UAAU,CAAC,WAAW,CAAC,CACxC,CAAC,CAED,mBACI5B,IAAA,CAACC,gBAAgB,CAAC4B,QAAQ,EAACC,KAAK,CAAE,CAAExB,SAAS,CAAEU,cAAc,CAAET,YAAY,CAAEmB,cAAe,CAAE,CAAAtB,QAAA,CACzFA,QAAQ,CACc,CAAC,CAEpC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}